import{j as E}from"./jsx-runtime.D_zvdyIk.js";import{r as D}from"./index.DMVOjPfi.js";import{g as st,d as rt,e as at,f as it}from"./date.DRKj0Afh.js";import{i as ot,r as lt,m as ut,a as ct,b as $,d as ft,c as mt,f as pt,e as ht,s as gt,p as dt,V as yt,g as At,h as St,j as Et,S as xt,H as vt,v as K,k as Vt,l as Dt,n as Tt}from"./single-value.DYvTnWkm.js";const Ot=(t,e,n)=>{const s=e-t;return((n-t)%s+s)%s+t};function q(t,e){return ot(t)?t[Ot(0,t.length,e)]:t}class jt{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>e.finished))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e){const n=this.animations.map(s=>s.attachTimeline(e));return()=>{n.forEach((s,r)=>{s&&s(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get state(){return this.getAll("state")}get startTime(){return this.getAll("startTime")}get duration(){return J(this.animations,"duration")}get iterationDuration(){return J(this.animations,"iterationDuration")}runAll(e){this.animations.forEach(n=>n[e]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function J(t,e){let n=0;for(let s=0;s<t.length;s++){const r=t[s][e];r!==null&&r>n&&(n=r)}return n}class bt extends jt{then(e,n){return this.finished.finally(e).then(()=>{})}}function L(t){return typeof t=="object"&&!Array.isArray(t)}function tt(t,e,n,s){return typeof t=="string"&&L(e)?lt(t,n,s):t instanceof NodeList?Array.from(t):Array.isArray(t)?t:[t]}function It(t,e,n){return t*(e+1)}function Q(t,e,n,s){return typeof e=="number"?e:e.startsWith("-")||e.startsWith("+")?Math.max(0,t+parseFloat(e)):e==="<"?n:e.startsWith("<")?Math.max(0,n+parseFloat(e.slice(1))):s.get(e)??t}function Mt(t,e,n){for(let s=0;s<t.length;s++){const r=t[s];r.at>e&&r.at<n&&(ct(t,r),s--)}}function wt(t,e,n,s,r,i){Mt(t,r,i);for(let a=0;a<e.length;a++)t.push({value:e[a],at:ut(r,i,s[a]),easing:q(n,a)})}function Ft(t,e){for(let n=0;n<t.length;n++)t[n]=t[n]/(e+1)}function Gt(t,e){return t.at===e.at?t.value===null?1:e.value===null?-1:0:t.at-e.at}const Nt="easeInOut";function Yt(t,{defaultTransition:e={},...n}={},s,r){const i=e.duration||.3,a=new Map,l=new Map,f={},o=new Map;let x=0,u=0,G=0;for(let O=0;O<t.length;O++){const h=t[O];if(typeof h=="string"){o.set(h,u);continue}else if(!Array.isArray(h)){o.set(h.name,Q(u,h.at,x,o));continue}let[T,g,m={}]=h;m.at!==void 0&&(u=Q(u,m.at,x,o));let p=0;const j=(d,y,v,b=0,I=0)=>{const c=Ct(d),{delay:P=0,times:A=ft(c),type:R="keyframes",repeat:N,repeatType:Qt,repeatDelay:Xt=0,...nt}=y;let{ease:V=e.ease||"easeOut",duration:S}=y;const W=typeof P=="function"?P(b,I):P,z=c.length,H=ht(R)?R:r?.[R||"keyframes"];if(z<=2&&H){let M=100;if(z===2&&Rt(c)){const w=c[1]-c[0];M=Math.abs(w)}const Y={...nt};S!==void 0&&(Y.duration=gt(S));const C=mt(Y,M,H);V=C.ease,S=C.duration}S??(S=i);const U=u+W;A.length===1&&A[0]===0&&(A[1]=1);const _=A.length-c.length;if(_>0&&pt(A,_),c.length===1&&c.unshift(null),N){S=It(S,N);const M=[...c],Y=[...A];V=Array.isArray(V)?[...V]:[V];const C=[...V];for(let w=0;w<N;w++){c.push(...M);for(let F=0;F<M.length;F++)A.push(Y[F]+(w+1)),V.push(F===0?"linear":q(C,F-1))}Ft(A,N)}const k=U+S;wt(v,c,V,A,U,k),p=Math.max(W+S,p),G=Math.max(k,G)};if($(T)){const d=X(T,l);j(g,m,Z("default",d))}else{const d=tt(T,g,s,f),y=d.length;for(let v=0;v<y;v++){g=g,m=m;const b=d[v],I=X(b,l);for(const c in g)j(g[c],Kt(m,c),Z(c,I),v,y)}}x=u,u+=p}return l.forEach((O,h)=>{for(const T in O){const g=O[T];g.sort(Gt);const m=[],p=[],j=[];for(let y=0;y<g.length;y++){const{at:v,value:b,easing:I}=g[y];m.push(b),p.push(dt(0,G,v)),j.push(I||"easeOut")}p[0]!==0&&(p.unshift(0),m.unshift(m[0]),j.unshift(Nt)),p[p.length-1]!==1&&(p.push(1),m.push(null)),a.has(h)||a.set(h,{keyframes:{},transition:{}});const d=a.get(h);d.keyframes[T]=m,d.transition[T]={...e,duration:G,ease:j,times:p,...n}}}),a}function X(t,e){return!e.has(t)&&e.set(t,{}),e.get(t)}function Z(t,e){return e[t]||(e[t]=[]),e[t]}function Ct(t){return Array.isArray(t)?t:[t]}function Kt(t,e){return t&&t[e]?{...t,...t[e]}:{...t}}const Pt=t=>typeof t=="number",Rt=t=>t.every(Pt);function Bt(t,e){return t in e}class Lt extends yt{constructor(){super(...arguments),this.type="object"}readValueFromInstance(e,n){if(Bt(n,e)){const s=e[n];if(typeof s=="string"||typeof s=="number")return s}}getBaseTargetFromProps(){}removeValueFromRenderState(e,n){delete n.output[e]}measureInstanceViewportBox(){return At()}build(e,n){Object.assign(e.output,n)}renderInstance(e,{output:n}){Object.assign(e,n)}sortInstanceNodePosition(){return 0}}function Wt(t){const e={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},n=St(t)&&!Et(t)?new xt(e):new vt(e);n.mount(t),K.set(t,n)}function zt(t){const e={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},n=new Lt(e);n.mount(t),K.set(t,n)}function Ht(t,e){return $(t)||typeof t=="number"||typeof t=="string"&&!L(e)}function et(t,e,n,s){const r=[];if(Ht(t,e))r.push(Vt(t,L(e)&&e.default||e,n&&(n.default||n)));else{const i=tt(t,e,s),a=i.length;for(let l=0;l<a;l++){const f=i[l],o=f instanceof Element?Wt:zt;K.has(f)||o(f);const x=K.get(f),u={...n};"delay"in u&&typeof u.delay=="function"&&(u.delay=u.delay(l,a)),r.push(...Dt(x,{...e,transition:u},{}))}}return r}function Ut(t,e,n){const s=[];return Yt(t,e,n,{spring:Tt}).forEach(({keyframes:i,transition:a},l)=>{s.push(...et(l,i,a))}),s}function _t(t){return Array.isArray(t)&&t.some(Array.isArray)}function kt(t){function e(n,s,r){let i=[],a;if(_t(n))i=Ut(n,s,t);else{const{onComplete:f,...o}=r||{};typeof f=="function"&&(a=f),i=et(n,s,o,t)}const l=new bt(i);return a&&l.finished.then(a),l}return e}const Jt=kt();function ee(){const[t,e]=D.useState(0),[n,s]=D.useState(0),[r,i]=D.useState(0),[a,l]=D.useState(0),f=()=>{const o=new Date;e(o.getFullYear());const x=st(rt(o),o);s(x),i(x/at(o)*100);const u=o.getTime()-it(o).getTime();l(u/86400/1e3*100)};return D.useEffect(()=>{f();const o=setInterval(f,1e3);return()=>{clearInterval(o)}},[]),E.jsxs(E.Fragment,{children:[E.jsxs("p",{className:"mt-4",children:["今天是 ",t," 年的第 ",E.jsx(B,{to:n,decimals:0})," 天"]}),E.jsxs("p",{className:"mt-4",children:["今年已过 ",E.jsx(B,{to:r,decimals:5}),"%"]}),E.jsxs("p",{className:"mt-4",children:["今天已过 ",E.jsx(B,{to:a,decimals:5}),"%"]})]})}function B({to:t,decimals:e,duration:n=1}){const s=D.useRef(null),r=D.useRef(0);return D.useEffect(()=>{if(!s.current)return;const i=Jt(r.current,t,{duration:n,onUpdate:a=>{s.current&&(s.current.textContent=a.toFixed(e))}});return r.current=t,()=>{i.stop()}},[t,e,n]),E.jsx("span",{ref:s})}export{ee as TimelineProgress};
